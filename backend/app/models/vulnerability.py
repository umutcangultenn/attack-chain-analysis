from pydantic import BaseModel
from typing import Optional, List
from enum import Enum

class VulnerabilityType(str, Enum):
    SQL_INJECTION = "SQL Injection"
    XSS = "Cross Site Scripting (XSS)"
    AUTH_BYPASS = "Authentication Bypass"
    RCE = "Remote Code Execution"
    SENSITIVE_DATA_EXPOSURE = "Sensitive Data Exposure"
    OTHER = "Other"

class Vulnerability(BaseModel):
    id: str
    type: VulnerabilityType
    name: str
    description: str
    severity: str  # High, Medium, Low, Info
    url: str
    method: str
    evidence: Optional[str] = None
    solution: Optional[str] = None
